SELECT
    AFL.BANK_NAME,
    NVL(SUM(AFL.AMOUNT), 0) AS AMOUNTS,
    NVL(SUM(TOTAL_UTILIZATION), 0) AS AVAILED,
    NVL(SUM(REMAINING), 0) AS BALANCE,

    (SELECT NVL(SUM(AFL1.AMOUNT), 0) 
     FROM AB_FACILITIES_LETTER AFL1 
     WHERE AFL1.FACILITIES_TYPE = 'LIMIT UTILIZATION'
       AND AFL1.ORG_ID = NVL(:GV_ORG_ID, AFL1.ORG_ID)) AS AMOUNT_TOTAL,

     (SELECT NVL(SUM(AFL1.TOTAL_UTILIZATION), 0) 
     FROM AB_FACILITIES_LETTER AFL1
     WHERE AFL1.FACILITIES_TYPE = 'LIMIT UTILIZATION'
       AND AFL1.ORG_ID = NVL(:GV_ORG_ID, AFL1.ORG_ID)) AS AMOUNT_AVAILED,

        (SELECT NVL(SUM(AFL1.REMAINING), 0) 
     FROM AB_FACILITIES_LETTER AFL1
     WHERE AFL1.FACILITIES_TYPE = 'LIMIT UTILIZATION'
       AND AFL1.ORG_ID = NVL(:GV_ORG_ID, AFL1.ORG_ID)) AS AMOUNT_REMAINING

  FROM AB_FACILITIES_LETTER AFL
  LEFT JOIN AB_FACILITIES_LETTER_DET AFLD ON AFLD.MAST_ID = AFL.ID
  WHERE AFL.FACILITIES_TYPE = 'LIMIT UTILIZATION'
  AND AFL.ORG_ID = NVL(:GV_ORG_ID, AFL.ORG_ID)
  GROUP BY 
    AFL.BANK_NAME;
